<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.2.0">Jekyll</generator><link href="https://web.chaehni.ch/feed.xml" rel="self" type="application/atom+xml" /><link href="https://web.chaehni.ch/" rel="alternate" type="text/html" /><updated>2021-05-04T12:07:42+02:00</updated><id>https://web.chaehni.ch/feed.xml</id><title type="html">Claude’s Blog</title><author><name>Claude Hähni</name></author><entry><title type="html">Building a SCION enabled Home Router</title><link href="https://web.chaehni.ch/networks/scion-home-router/" rel="alternate" type="text/html" title="Building a SCION enabled Home Router" /><published>2021-02-25T00:00:00+01:00</published><updated>2021-03-19T00:00:00+01:00</updated><id>https://web.chaehni.ch/networks/scion-home-router</id><content type="html" xml:base="https://web.chaehni.ch/networks/scion-home-router/">&lt;p&gt;The goal of this project is to build my own home router to access the Internet.
In a second step, I then want to enable
&lt;a href=&quot;https://scion-architecture.net&quot;&gt;SCION&lt;/a&gt; support on the router by installing the
SCION stack. The result will be a home router that can natively speak the SCION protocol
and even translate between legacy IP and SCION using the
&lt;a href=&quot;https://docs.scionlab.org/content/apps/remote_sig.html&quot;&gt;SCION IP Gateway (SIG)&lt;/a&gt;. Of
course, regular IP traffic should not be affected and work just fine in parallel
to SCION.&lt;/p&gt;

&lt;h2 id=&quot;why-build-your-own-home-router&quot;&gt;Why build your own home router?&lt;/h2&gt;

&lt;p&gt;Reading the title of this post you might ask yourself: “Why build your own
router when my ISP ships a perfectly capable router already?”
The truth is that ISPs, like all companies, operate on a budget. It’s in their
interest to sell as many Internet connections as possible for as low a cost as
possible. ISP provided routers tend to be bad in a couple of ways:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ISP routers tend to be configured for their convenience and not for security
in order to cut down on tech support.&lt;/li&gt;
  &lt;li&gt;Often, these devices are locked down in one way or the other. Certain features may not be available
and cannot be added by the end user. I think that users should have full
control over the devices they run in their own network.&lt;/li&gt;
  &lt;li&gt;Updates to ISP provided routers are a rare thing (if they happen at all).
Something as critical as your router, protecting your home network from the
Internet, should always operate with the latest security patches applied.&lt;/li&gt;
  &lt;li&gt;Potentially millions of people run the exact same router with the exact same
standard configuration, making these routers a prime target for any attacker.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;overview&quot;&gt;Overview&lt;/h2&gt;

&lt;p&gt;With the “Why?” out of the way, I’d now like to provide an overview of my envisioned router.&lt;/p&gt;

&lt;p&gt;The figure below shows an abstraction of the desired outcome. The router
contains an IP and a SCION stack which are connected to their respective
upstream networks. Between the two stacks sits the SIG which translates between
IP and SCION. Clients can connect to the router via Ethernet or Wi-Fi.
Independent of the connection, clients can make use of both network stacks.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/scion-router/usecase_overview.png&quot; alt=&quot;Usecase Overview&quot; title=&quot;Router Overview&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It is clear, that IP packets from my client devices will use the IP stack on the router
while SCION packets will use the SCION stack. However, with the SIG I have the
possibility to translate certain IP connections to SCION connections. This is
useful to make applications that are completely oblivious of SCION benefit from
SCION features such as path selection, multi-path communication and hidden
paths. The downside is that on the other end another SIG is needed
to translate the SCION packets back to IP. This means that I need prior knowledge
about which IP addresses sit behind a SIG and can therefore be accessed via
SCION. I need to manually configure these address on my home router,
such that it knows to send corresponding packets via the SIG, translating the
connections to SCION. The goal is to make this configuration easily
accessible via the router’s web interface.&lt;/p&gt;

&lt;p class=&quot;notice--info&quot;&gt;A few words about residential SCION connectivity: Because most ISPs, like mine, don’t yet
offer a native SCION connection, I will connect my router to the
&lt;a href=&quot;https://www.scionlab.org/&quot;&gt;SCIONLab&lt;/a&gt; network. SCIONLab is a global research
network, open to anyone who wants to try out SCION. Once my ISP offers
access to the SCION production network I’ll be able to easily switch over to
that network.&lt;/p&gt;

&lt;h2 id=&quot;the-hardware&quot;&gt;The Hardware&lt;/h2&gt;

&lt;p&gt;For the hardware, I chose the APU platform from &lt;a href=&quot;https://www.pcengines.ch/&quot;&gt;PC
Engines&lt;/a&gt; which is a widely adopted server platform
for low power, wireless networking and embedded applications based on the x86
architecture. All the parts required for this build are listed below.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Part&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;apu2e4&lt;/td&gt;
      &lt;td&gt;APU.2E4 system board (GX-412TC quad core / 4GB / 3 Intel GigE / 2 miniPCI express / mSATA / USB / RTC battery)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;case1d2bluu&lt;/td&gt;
      &lt;td&gt;Enclosure for alix2 / apu1 / apu2 (3 LAN, blue, USB)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;ac12veur3&lt;/td&gt;
      &lt;td&gt;AC adapter with euro plug&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;msata16g&lt;/td&gt;
      &lt;td&gt;16GB mSATA SSD module&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;wle600vx&lt;/td&gt;
      &lt;td&gt;Compex WLE600VX 802.11ac miniPCI express wireless card&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2 x antsmadb&lt;/td&gt;
      &lt;td&gt;Antenna&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2 x pigsma&lt;/td&gt;
      &lt;td&gt;IPEX to reverse SMA pigtail cable&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;usbcom1a&lt;/td&gt;
      &lt;td&gt;USB to DB9F serial adapter&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;assembling-the-router&quot;&gt;Assembling the Router&lt;/h3&gt;

&lt;p&gt;For the basic assembly of the APU I followed this video:&lt;/p&gt;

&lt;p&gt;
&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/ft_Ic2ZdLHw&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;
&lt;/p&gt;

&lt;p&gt;In addition to the standard setup, of course I also wanted my router to be Wi-Fi capable!
For that reason I installed the miniPCI wireless card and the antennas.&lt;/p&gt;

&lt;p&gt;Internals of my router:
&lt;img src=&quot;/assets/images/scion-router/router_internals.jpg&quot; alt=&quot;Router internals&quot; title=&quot;Router internals&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This is what my fully assembled router looks like:
&lt;img src=&quot;/assets/images/scion-router/router.jpg&quot; alt=&quot;Full assembled SCION Router&quot; title=&quot;Fully assembled SCION Router&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;the-software&quot;&gt;The Software&lt;/h2&gt;

&lt;p&gt;Of course, hardware alone doesn’t make a router. Luckily, there are excellent
open-source router platforms available. One of them is OpenWRT.&lt;/p&gt;

&lt;h3 id=&quot;openwrt&quot;&gt;OpenWRT&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://openwrt.org/&quot;&gt;OpenWRT&lt;/a&gt; is a full Linux-based operating system
designed for wireless routers. It offers a writable file system and it even
includes a package manager which makes the OS highly extensible. OpenWRT has
wide support for different hardware, including our
&lt;a href=&quot;https://openwrt.org/toh/pcengines/apu2&quot;&gt;APU2&lt;/a&gt; board.&lt;/p&gt;

&lt;p&gt;OpenWRT ships with a web UI called LuCI. LuCI is your typical router’s user
interface which you can access over the web (usually &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;192.168.1.1&lt;/code&gt;).
However, like everything else about OpenWRT it is very feature rich and highly customizable.&lt;/p&gt;

&lt;h3 id=&quot;accessing-the-board&quot;&gt;Accessing the board&lt;/h3&gt;

&lt;p&gt;Since the APU2 board does not have a display output and SSH is only available
once the OS is installed, we need to rely on the DB9 serial port to establish a
connection. There are several serial communication programs available. I used
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;picocom&lt;/code&gt;. The following command connects to the board
over the USB-to-serial cable plugged into my computer and the APU:&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;picocom -b 115200 /dev/ttyUSB0&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;115200 is the baud rate (or symbol rate) of the APU.&lt;/p&gt;

&lt;h3 id=&quot;flashing-the-os&quot;&gt;Flashing the OS&lt;/h3&gt;

&lt;p&gt;At the time of writing, the most recent OpenWRT version is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;19.06.4&lt;/code&gt; and can
be downloaded from
&lt;a href=&quot;https://downloads.openwrt.org/releases/18.06.4/targets/x86/64/&quot;&gt;here&lt;/a&gt;.
I’ll be using the Ext4 file system instead of the squashfs because I’d like to
have a fully writable file system and space limitations are not a concern thanks
to the large 16GB SSD installed in the board. The OS comes with two partitions, the boot partition and
the root file system partition. I used to following steps to flash the OS to the
board and expand the root file system to us the full size of the SDD (instead of
an SD card, one can also use a USB thumb drive):&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Copy the downloaded image onto to an SD card: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;gzip -dc openwrt-19.07.7-x86-64-combined-ext4.img.gz | sudo dd status=progress bs=8M of=/dev/sdX&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Boot the board from SD card&lt;/li&gt;
  &lt;li&gt;Clone the SD onto the SSD drive: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dd bs=8M if=/dev/mmcblk0 of=/dev/sda&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;The root partition now has the same size (256M) as the SD. We need to increase it:
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fdisk /dev/sda&lt;/code&gt; (fdisk needs to be installed)&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;d 2&lt;/code&gt; to delete the root file system partition on the SSD&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;n 2&lt;/code&gt; to create a new partition, when asked for input accept standard values&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;p&lt;/code&gt; to see the new partition layout, confirm the second partition has increased in size&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;w&lt;/code&gt; to write the changes to disk&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Copy over the root file system from the SD card: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dd bs=8M if=/dev/mmcblk0p2 of=/dev/sda2&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Expand the file system to make use of the entire partition:
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;e2fsck -f /dev/sda2&lt;/code&gt; (accept eventual repairs)&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;resize2fs /dev/sda2&lt;/code&gt; (resize2fs needs to be installed)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;remove the SD card and boot from SSD, confirm the root partition &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dev/root&lt;/code&gt; has increased in size: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;df -h&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Success! The router can now be accessed via browser at &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;192.168.1.1&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot; &quot;&gt;
  
    
      &lt;a href=&quot;/assets/images/scion-router/luci.png&quot; title=&quot;LuCI router interface&quot;&gt;
          &lt;img src=&quot;/assets/images/scion-router/luci.png&quot; alt=&quot;LuCI router interface&quot; /&gt;
      &lt;/a&gt;
    
  
  
&lt;/figure&gt;

&lt;h3 id=&quot;enabling-wi-fi&quot;&gt;Enabling Wi-Fi&lt;/h3&gt;

&lt;p&gt;OpenWRT does not ship with the driver and firmware for the wle600vx Wi-Fi card out of the box. The following packages need to be installed manually:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ath10k-firmware-qca988x&lt;/code&gt; - the firmware for the Qualcom Atheros 9882 SoC on the card&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;kmod-ath10k&lt;/code&gt; - the driver for our Atheros based card&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;wpad-mini&lt;/code&gt; - for adding support for strong crypthographic authentication, such as WPA2&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;After a reboot, the Wi-Fi card should be recognized and show up in the LuCI interface.&lt;/p&gt;

&lt;h2 id=&quot;make-it-speak-scion&quot;&gt;Make it speak SCION&lt;/h2&gt;

&lt;p&gt;So far, I have a fully functional and highly configurable router, where I
control the hard- and software. This was the first goal of the project. The next
step is now to install the SION stack on the router. The plan is to run
a full SCION autonomous system (AS) inside the router. For this, I will install
the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SCION Control Service&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SCION Border Router&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SCION Dispatcher&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SCION Daemon&lt;/code&gt;
and the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SCION IP Gateway&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&quot;compiling-the-scion-binaries&quot;&gt;Compiling the SCION binaries&lt;/h3&gt;

&lt;p&gt;The services listed above are written in Google’s &lt;a href=&quot;https://golang.org/&quot;&gt;Go&lt;/a&gt;
programming language and are targeting Debian x86 systems. However, some
of the services call functions from the C standard library behind the scenes.
Since Debian uses the GNU C Library (glibc), the services are dynamically
linking against that specific libc implementation. Usually this is not a
problem. However, OpenWRT uses musl-libc which means that
the services need to be compiled from source against musl-libc.
Luckily, it is easy to adapt the usual &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;go build&lt;/code&gt; command to accept a C compiler
other than the default.
The following commands build the binaries using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;musl-gcc&lt;/code&gt; which is a wrapper for the
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;gcc&lt;/code&gt; toolchain that targets musl-libc instead of glibc:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;CC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/local/musl/bin/musl-gcc go build &lt;span class=&quot;nt&quot;&gt;--ldflags&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'-linkmode external'&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;CC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/local/musl/bin/musl-gcc go build &lt;span class=&quot;nt&quot;&gt;--ldflags&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'-linkmode external -extldflags &quot;-static&quot;'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The first command builds dynamically linked binaries whereas the second command
builds statically linked binaries.&lt;/p&gt;

&lt;h3 id=&quot;adding-a-scion-tab-to-the-luci-interface&quot;&gt;Adding a SCION tab to the LuCI interface&lt;/h3&gt;

&lt;p&gt;With the back end ready to to speak SCION, the only thing missing now is a new
tab in the LuCI user interface to configure the SCION configuration.&lt;/p&gt;

&lt;p&gt;A brief explanation on how to add a new tab to the LuCI interface can be found
&lt;a href=&quot;https://openwrt.org/docs/guide-developer/luci&quot;&gt;here&lt;/a&gt;. Essentially, it requires
a web view written in HTML together with a back end written in Lua. I added a SCION tab with
two sub-tabs, one for the SCION configuration and one for the SIG configuration.&lt;/p&gt;

&lt;p&gt;This is the result:&lt;/p&gt;

&lt;figure class=&quot;half &quot;&gt;
  
    
      &lt;a href=&quot;/assets/images/scion-router/luci_scion_setup.png&quot; title=&quot;SCION setup interface&quot;&gt;
          &lt;img src=&quot;/assets/images/scion-router/luci_scion_setup.png&quot; alt=&quot;SCION setup interface&quot; /&gt;
      &lt;/a&gt;
    
  
    
      &lt;a href=&quot;/assets/images/scion-router/luci_scion_sig.png&quot; title=&quot;SIG setup interface&quot;&gt;
          &lt;img src=&quot;/assets/images/scion-router/luci_scion_sig.png&quot; alt=&quot;SIG setup interface&quot; /&gt;
      &lt;/a&gt;
    
  
  
&lt;/figure&gt;

&lt;p&gt;I can upload any valid SCION configuration and then use the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Start&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Restart&lt;/code&gt; and
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Stop&lt;/code&gt; buttons to control the SCION installation through the convenience of
the LuCI interface. Additionally, SIG rules can be defined and the SIG can be
started and stopped independently of SCION.&lt;/p&gt;

&lt;h2 id=&quot;testing&quot;&gt;Testing&lt;/h2&gt;

&lt;h3 id=&quot;bandwidth-measurements&quot;&gt;Bandwidth measurements&lt;/h3&gt;

&lt;p&gt;To make sure everything works as expected and to get a sense of the performance, I first tested basic IP connectivity using &lt;a href=&quot;https://speedtest.net&quot;&gt;speedtest.net&lt;/a&gt; via Ethernet and Wi-Fi.&lt;/p&gt;

&lt;h4 id=&quot;ethernet&quot;&gt;Ethernet&lt;/h4&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/scion-router/speedtest_ethernet.png&quot; alt=&quot;Dowload and upload speed over Ethernet&quot; title=&quot;Dowload
and upload speed over Ethernet&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;wi-fi&quot;&gt;Wi-Fi&lt;/h4&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/scion-router/speedtest_wifi.jpg&quot; alt=&quot;Dowload and upload speed over WiFi&quot; title=&quot;Dowload
and upload speed over WiFi&quot; /&gt;&lt;/p&gt;

&lt;p&gt;(SCION measurements follow)&lt;/p&gt;

&lt;h2 id=&quot;presentation&quot;&gt;Presentation&lt;/h2&gt;

&lt;p&gt;The SCION home router has been showcased at the SCION Day on November 6, 2019.
Find the slides and video here: &lt;a href=&quot;https://video.ethz.ch/events/2019/scion/61dd8a87-3894-489d-99d3-77ca66c5ad38.html&quot;&gt;SCION Day presentation&lt;/a&gt;.&lt;/p&gt;</content><author><name>Claude Hähni</name></author><category term="Networks" /><category term="Hardware" /><category term="SCION" /><category term="OpenWRT" /><summary type="html">How to bring SCION into your home!</summary></entry><entry><title type="html">Adding teaser images to the “Recent posts” list</title><link href="https://web.chaehni.ch/web/blog-thumbnails/" rel="alternate" type="text/html" title="Adding teaser images to the “Recent posts” list" /><published>2021-02-19T00:00:00+01:00</published><updated>2021-02-19T00:00:00+01:00</updated><id>https://web.chaehni.ch/web/blog-thumbnails</id><content type="html" xml:base="https://web.chaehni.ch/web/blog-thumbnails/">&lt;p&gt;For my blog, I wanted to have teaser images in the “Recent posts” overview shown on
the main page.
Unfortunately, the Jekyll theme I use for this blog,
&lt;a href=&quot;https://github.com/mmistakes/minimal-mistakes&quot;&gt;minimal-mistakes&lt;/a&gt;, does not
support this out of the box. A quick search on the Internet revealed many people
with the same goal but no solution. Being new to Jekyll, I took
this as an opportunity to fiddle around and implement the solution myself.&lt;br /&gt;
In this short post I’m going to explain how I added this
functionality.&lt;/p&gt;

&lt;figure class=&quot; &quot;&gt;
  
    
      &lt;a href=&quot;/assets/images/post-teasers/before-after.png&quot; title=&quot;Before and after comparison&quot;&gt;
          &lt;img src=&quot;/assets/images/post-teasers/before-after.png&quot; alt=&quot;&quot; /&gt;
      &lt;/a&gt;
    
  
  
&lt;/figure&gt;

&lt;p&gt;The “Recent posts” list is generated by the &lt;em&gt;home&lt;/em&gt; layout definition which is loaded by the
index page &lt;em&gt;index.html&lt;/em&gt;. The &lt;em&gt;home&lt;/em&gt; layout in turn includes the
&lt;em&gt;archive-single.html&lt;/em&gt; file which is responsible for displaying the “Recent
posts” as well as the “You may also enjoy” section found under every post. By
default, the teaser image defined in a post is only added if the individual posts
are organized as grid. You can see this check and the rendering of the
teaser image on lines five to nine in the code below. This leaves our blog post list without teaser images since it gets
structured as list, not as grid.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-liquid&quot; data-lang=&quot;liquid&quot;&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;_includes/archive-single.html

&amp;lt;div class=&quot;&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'list'&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;__item&quot;&amp;gt;
  &amp;lt;article class=&quot;archive__item&quot; itemscope itemtype=&quot;https://schema.org/CreativeWork&quot;&amp;gt;
    &lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;grid&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;teaser&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
    &amp;lt;div class=&quot;archive__item-teaser&quot;&amp;gt;
      &amp;lt;img src=&quot;&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;teaser&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;relative_url&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;&quot; alt=&quot;&quot;&amp;gt;
    &amp;lt;/div&amp;gt;
    &lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;endif&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
    &amp;lt;h2 class=&quot;archive__item-title no_toc&quot; itemprop=&quot;headline&quot;&amp;gt;
      &lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;link&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
      &amp;lt;a href=&quot;&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;link&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;&quot;&amp;gt;&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;&amp;lt;/a&amp;gt; &amp;lt;a href=&quot;&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;relative_url&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;&quot; rel=&quot;permalink&quot;&amp;gt;&amp;lt;i
          class=&quot;fas fa-link&quot; aria-hidden=&quot;true&quot; title=&quot;permalink&quot;&amp;gt;&amp;lt;/i&amp;gt;&amp;lt;span class=&quot;sr-only&quot;&amp;gt;Permalink&amp;lt;/span&amp;gt;&amp;lt;/a&amp;gt;
      &lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
      &amp;lt;a href=&quot;&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;relative_url&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;&quot; rel=&quot;permalink&quot;&amp;gt;&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;&amp;lt;/a&amp;gt;
      &lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;endif&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
    &amp;lt;/h2&amp;gt;
    &lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;page__meta.html&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;na&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;include.type&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;excerpt&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;&amp;lt;p class=&quot;archive__item-excerpt&quot; itemprop=&quot;description&quot;&amp;gt;&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;excerpt&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;markdownify&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;strip_html&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;truncate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;160&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;&amp;lt;/p&amp;gt;&lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;endif&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
  &amp;lt;/article&amp;gt;
&amp;lt;/div&amp;gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The solution is straight forward: We add the following code to the template
which checks if posts are structured as a list and if yes, adds the teaser image.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-liquid&quot; data-lang=&quot;liquid&quot;&gt;&lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;list&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;teaser&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
    &amp;lt;div class=&quot;thumbnail-container&quot;&amp;gt;
      &amp;lt;img src=&quot;&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;teaser&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;relative_url&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;&quot; alt=&quot;&quot;&amp;gt;
    &amp;lt;/div&amp;gt;
&lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;endif&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;I added the code between the rendering of the post meta data and the excerpt,
specifically between lines 18 and 19 in the original code. The updated code
looks like this:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-liquid&quot; data-lang=&quot;liquid&quot;&gt;_includes/archive-single.html

&amp;lt;div class=&quot;&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'list'&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;__item&quot;&amp;gt;
  &amp;lt;article class=&quot;archive__item&quot; itemscope itemtype=&quot;https://schema.org/CreativeWork&quot;&amp;gt;
    &lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;grid&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;teaser&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
    &amp;lt;div class=&quot;archive__item-teaser&quot;&amp;gt;
      &amp;lt;img src=&quot;&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;teaser&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;relative_url&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;&quot; alt=&quot;&quot;&amp;gt;
    &amp;lt;/div&amp;gt;
    &lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;endif&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
    &amp;lt;h2 class=&quot;archive__item-title no_toc&quot; itemprop=&quot;headline&quot;&amp;gt;
      &lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;link&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
      &amp;lt;a href=&quot;&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;link&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;&quot;&amp;gt;&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;&amp;lt;/a&amp;gt; &amp;lt;a href=&quot;&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;relative_url&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;&quot; rel=&quot;permalink&quot;&amp;gt;&amp;lt;i
          class=&quot;fas fa-link&quot; aria-hidden=&quot;true&quot; title=&quot;permalink&quot;&amp;gt;&amp;lt;/i&amp;gt;&amp;lt;span class=&quot;sr-only&quot;&amp;gt;Permalink&amp;lt;/span&amp;gt;&amp;lt;/a&amp;gt;
      &lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
      &amp;lt;a href=&quot;&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;relative_url&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;&quot; rel=&quot;permalink&quot;&amp;gt;&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;&amp;lt;/a&amp;gt;
      &lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;endif&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
    &amp;lt;/h2&amp;gt;
    &lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;page__meta.html&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;na&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;include.type&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;list&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;teaser&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
    &amp;lt;div class=&quot;thumbnail-container&quot;&amp;gt;
      &amp;lt;img src=&quot;&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;teaser&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;relative_url&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;&quot; alt=&quot;&quot;&amp;gt;
    &amp;lt;/div&amp;gt;
    &lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;endif&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;excerpt&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;&amp;lt;p class=&quot;archive__item-excerpt&quot; itemprop=&quot;description&quot;&amp;gt;&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;excerpt&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;markdownify&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;strip_html&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;truncate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;160&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;&amp;lt;/p&amp;gt;&lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;endif&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
  &amp;lt;/article&amp;gt;
&amp;lt;/div&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;You may have noticed the extra CSS &lt;em&gt;thumbnail-container&lt;/em&gt; class added to the
element. To save vertical space in the blog post list, I wanted to crop the
teasers at the top and the bottom. This is handled by the custom CSS class.
For that, I simply added the code below to the other CSS
definitions in the assets folder.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-css&quot; data-lang=&quot;css&quot;&gt;&lt;span class=&quot;nc&quot;&gt;.thumbnail-container&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nl&quot;&gt;max-width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;100%&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nl&quot;&gt;overflow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nl&quot;&gt;border-radius&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;5px&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nl&quot;&gt;margin-bottom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;25px&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;.thumbnail-container&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;img&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nl&quot;&gt;margin-top&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-11.5%&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nl&quot;&gt;margin-bottom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-11.5%&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;</content><author><name>Claude Hähni</name></author><category term="Web" /><category term="Jekyll" /><category term="Liquid" /><category term="HTML" /><category term="CSS" /><summary type="html">For my blog, I wanted to have teaser images in the “Recent posts” overview shown on the main page. Unfortunately, the Jekyll theme I use for this blog, minimal-mistakes, does not support this out of the box. A quick search on the Internet revealed many people with the same goal but no solution. Being new to Jekyll, I took this as an opportunity to fiddle around and implement the solution myself. In this short post I’m going to explain how I added this functionality.</summary></entry></feed>